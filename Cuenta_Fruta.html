<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beast Challenge: El Contador Ajustable</title>
    <style>
        body {
            background-color: #0b0e14;
            color: white;
            font-family: 'Arial Black', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        #stage {
            width: 85vw;
            height: 45vh;
            background: #1e293b;
            border: 4px solid #facc15;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .emoji {
            position: absolute;
            font-size: 4rem;
            user-select: none;
            transition: transform 0.1s linear;
        }

        #config-panel {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            width: 300px;
        }

        input[type=range] { width: 100%; cursor: pointer; }

        .btn {
            padding: 12px 30px;
            font-size: 1.2rem;
            background: #facc15;
            color: #000;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
        }

        #question-box {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .answer-btn {
            padding: 10px 20px;
            font-size: 1.5rem;
            margin: 5px;
            cursor: pointer;
            background: #334155;
            color: white;
            border: 2px solid #facc15;
            border-radius: 10px;
        }

        #result { font-size: 2rem; margin-top: 15px; }
    </style>
</head>
<body>

    <h1 style="color: #facc15;">üî¢ EL CONTADOR: MODO CONTROL üî¢</h1>
    
    <div id="config-panel">
        <label>Velocidad: <span id="speed-val">1.5</span>s</label><br>
        <input type="range" id="speed-slider" min="0.5" max="4" step="0.5" value="1.5">
        <button id="start-btn" class="btn" onclick="startChallenge()">LANZAR RETO</button>
    </div>

    <div id="stage">
        <div id="msg">Ajusta la velocidad y dale a empezar</div>
    </div>

    <div id="question-box">
        <h2 id="question-text"></h2>
        <div id="options"></div>
    </div>

    <div id="result"></div>

    <script>
        const emojiPool = ['üçé', 'üçå', 'üçá', 'üçí', 'üçì', 'üçç'];
        const slider = document.getElementById('speed-slider');
        const speedVal = document.getElementById('speed-val');
        
        let counts = {};
        let targetEmoji = '';

        slider.oninput = function() { speedVal.innerText = this.value; }

        function startChallenge() {
            counts = {};
            const speed = parseFloat(slider.value) * 1000;
            const stage = document.getElementById('stage');
            
            document.getElementById('config-panel').style.display = 'none';
            document.getElementById('question-box').style.display = 'none';
            document.getElementById('result').innerText = '';
            stage.innerHTML = '';

            const totalItems = 10; // L√≠mite estricto de 10

            for (let i = 0; i < totalItems; i++) {
                const emoji = emojiPool[Math.floor(Math.random() * emojiPool.length)];
                counts[emoji] = (counts[emoji] || 0) + 1;
                
                setTimeout(() => spawnEmoji(emoji, speed), i * (speed * 0.7));
            }

            setTimeout(askQuestion, totalItems * (speed * 0.7) + speed);
        }

        function spawnEmoji(char, duration) {
            const el = document.createElement('div');
            el.className = 'emoji';
            el.innerText = char;
            el.style.left = '-100px';
            el.style.top = Math.random() * 70 + 10 + '%';
            document.getElementById('stage').appendChild(el);

            // Animaci√≥n manual con JS para control total de velocidad
            let start = null;
            function step(timestamp) {
                if (!start) start = timestamp;
                let progress = (timestamp - start) / duration;
                el.style.left = (progress * 120) - 10 + '%';
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                } else {
                    el.remove();
                }
            }
            window.requestAnimationFrame(step);
        }

        function askQuestion() {
            const keys = Object.keys(counts);
            targetEmoji = keys[Math.floor(Math.random() * keys.length)];
            
            document.getElementById('question-text').innerText = `¬øCu√°ntos ${targetEmoji} pasaron?`;
            document.getElementById('question-box').style.display = 'block';
            
            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = '';
            
            // Crear botones de respuesta (0 al 10)
            for (let i = 0; i <= 5; i++) { // Simplificado para que sea m√°s f√°cil elegir
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.innerText = i;
                btn.onclick = () => checkAnswer(i);
                optionsDiv.appendChild(btn);
            }
        }

        function checkAnswer(val) {
            const correct = counts[targetEmoji] || 0;
            const res = document.getElementById('result');
            
            if (val === correct) {
                res.innerHTML = "‚úÖ ¬°EXCELENTE! <br> Eres muy r√°pido.";
                res.style.color = "#22c55e";
            } else {
                res.innerHTML = `‚ùå ¬°OH NO! <br> Hab√≠a ${correct} ${targetEmoji}.`;
                res.style.color = "#ef4444";
            }

            setTimeout(() => {
                document.getElementById('config-panel').style.display = 'block';
                document.getElementById('result').innerText = '';
                document.getElementById('stage').innerHTML = '¬°Listo para otra ronda!';
            }, 3000);
        }
    </script>
</body>
</html>